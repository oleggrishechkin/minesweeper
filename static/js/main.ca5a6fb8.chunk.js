(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{24:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r,o,c,a,l,i=n(1),u=n(15),b=(n(24),n(4)),s=n(6),d=n(5),f=n(2),j=Object(f.createTagged)(null),g=n(3),O=function(e,t){for(var n,r=0,o=-1;o<=1;++o)for(n=-1;n<=1;++n){var c,a;(null===(a=null===(c=e.board[n+t.row])||void 0===c?void 0:c[o+t.col])||void 0===a?void 0:a.isBomb)&&++r}return r||null},v=function(e,t){for(var n,r,o,c,a=[t];a.length;)if((n=a.pop())&&!n.isOpened&&!n.isFlag&&(n=e.board[n.row][n.col]=Object(g.a)(Object(g.a)({},n),{},{isOpened:!0,bombCount:O(e,n)}),e.cells-=1,!n.bombCount))for(o=-1;o<=1;++o)for(c=-1;c<=1;++c){var l;!(r=null===(l=e.board[c+n.row])||void 0===l?void 0:l[o+n.col])||-1!==a.indexOf(r)||r.isOpened||r.isFlag||a.push(r)}return e},m=n(19),h=function(e){return Object(g.a)(Object(g.a)({},e),{},{board:Object(m.a)(e.board)})},p=Object(f.createTagged)(null),x=Object(f.createTagged)(null),w=function(e){for(var t,n=0,r=e.board.length,o=e.board[0].length;n<r;++n)for(t=0;t<o;t++)e.board[n][t].isBomb&&(e.board[n][t]=Object(g.a)(Object(g.a)({},e.board[n][t]),{},{isFlag:!0}));return e},T=function(){p(Date.now()),x("win"),j((function(e){return e&&w(h(e))}))},y=function(e){for(var t,n=0,r=e.board.length,o=e.board[0].length;n<r;++n)for(t=0;t<o;t++)e.board[n][t].isBomb&&(e.board[n][t]=Object(g.a)(Object(g.a)({},e.board[n][t]),{},{isOpened:!0}));return e},B=function(){p(Date.now()),x("lose"),j((function(e){return e&&y(h(e))}))},F=function(e){var t;!e||e.isOpened||e.isFlag||(e.isBomb?B():(j((function(t){return t&&v(h(t),e)})),0===(null===(t=j())||void 0===t?void 0:t.cells)&&T()))},M=function(e,t){if(!e)return 0;for(var n,r,o=0,c=!1,a=-1;a<=1;++a)for(n=-1;n<=1;++n){var l,i,u;(null===(i=r=null===(l=e.board[n+t.row])||void 0===l?void 0:l[a+t.col])||void 0===i?void 0:i.isFlag)?o++:(null===(u=r)||void 0===u?void 0:u.isBomb)&&(c=!0)}return o===t.bombCount?c?-1:1:0},C=function(e,t){for(var n,r=-1;r<=1;++r)for(n=-1;n<=1;++n){var o;v(e,null===(o=e.board[n+t.row])||void 0===o?void 0:o[r+t.col])}return e},k=function(e){switch(M(j(),e)){case-1:return void B();case 1:var t;j((function(t){return t&&C(h(t),e)})),0===(null===(t=j())||void 0===t?void 0:t.cells)&&T()}},R=function(e,t){var n=t.isFlag;return e.board[t.row][t.col]=Object(g.a)(Object(g.a)({},e.board[t.row][t.col]),{},{isFlag:!n}),e.flags+=n?1:-1,e},S=function(e){var t;!e.isOpened&&(e.isFlag||((null===(t=j())||void 0===t?void 0:t.flags)||0)>0)&&j((function(t){return t&&R(h(t),e)}))},D=function(e,t){return[Math.floor(Math.random()*t),Math.floor(Math.random()*e)]},E=function(e,t,n,r,o){for(var c,a=[],l=0,i=0;i<t;++i)for(a[i]=[],c=0;c<e;++c)a[i][c]={id:"[".concat(i,"][").concat(c,"]"),row:i,col:c,bombCount:null,isBomb:!1,isFlag:!1,isOpened:!1};for(;l<n;){var u=D(e,t),b=Object(d.a)(u,2);i=b[0],c=b[1],a[i][c].isBomb||i===r&&o===c||(a[i][c].isBomb=!0,++l)}return{board:a,flags:n,cells:e*t-n}},I=Object(f.createTagged)(30),A=Object(f.createTagged)(16),L=Object(f.createTagged)(99),V=Object(f.createTagged)(null),q=function(e,t){var n;j(E(I(),A(),L(),e,t)),V(Date.now()),F(null===(n=j())||void 0===n?void 0:n.board[e][t])},H=20,J=10,U="BOARD_ID",N={1:"blue",2:"green",3:"red",4:"purple",5:"maroon",6:"turquoise",7:"black",8:"gray"},W=n(0),X=Object(i.memo)((function(e){var t=e.cell;return Object(i.useLayoutEffect)((function(){var e=document.getElementById(U).getContext("2d");e&&function(e,t){var n=t.cell,r=n.col*H,o=n.row*H;e.fillStyle="black",e.fillRect(r,o,H,H),e.fillStyle=n.isOpened?"aliceblue":"lightgray",e.fillRect(r,o,19,19),e.font="12px -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif",e.textAlign="center",e.textBaseline="middle",n.isOpened?n.isBomb?n.isFlag?e.fillText("\u2705",r+J-1,o+J):e.fillText("\ud83d\udca3",r+J-1,o+J):n.bombCount&&(N[n.bombCount]&&(e.fillStyle=N[n.bombCount]),e.fillText("".concat(n.bombCount),r+J-1,o+J)):n.isFlag&&e.fillText("\ud83d\udea9",r+J-1,o+J)}(e,{cell:t})}),[t]),Object(W.jsx)(i.Fragment,{})})),Y=function(e){var t=e.parentRef,n=e.board,r=e.children,o=Object(i.useState)((function(){return[[0,0],[0,0]]})),c=Object(d.a)(o,2),a=c[0],l=c[1];Object(i.useLayoutEffect)((function(){var e;return function n(){if(t.current){var r=t.current.getBoundingClientRect(),o=Math.floor(t.current.scrollTop/H),c=Math.ceil((t.current.scrollTop+r.height)/H),a=Math.floor(t.current.scrollLeft/H),i=Math.ceil((t.current.scrollLeft+r.width)/H);l((function(e){return e[0][0]===o&&e[0][1]===c&&e[1][0]===a&&e[1][1]===i?e:[[o,c],[a,i]]}))}e=requestAnimationFrame(n)}(),function(){cancelAnimationFrame(e)}}),[t]);var u=Object(i.useMemo)((function(){for(var e,t=[],o=a[0][0],c=n.length,l=n[0].length;o<a[0][1]&&o<c;++o)for(e=a[1][0];e<a[1][1]&&e<l;++e)t.push(r({cell:n[o][e]}));return t}),[n,r,a]);return Object(W.jsx)(i.Fragment,{children:u})},_=s.a.section(r||(r=Object(b.a)(["\n    display: flex;\n    overflow: auto;\n    max-width: 100%;\n    border-top: 1px solid black;\n    border-left: 1px solid black;\n"]))),z=function(e){var t,n=null===(t=document.getElementById(U))||void 0===t?void 0:t.getBoundingClientRect();return n?[Math.floor((e.clientY-n.top)/H),Math.floor((e.clientX-n.left)/H)]:[0,0]},G=function(){var e=Object(i.useRef)(null),t=Object(f.useTagged)(j),n=Object(f.useTagged)(x),r=Object(f.useTagged)(I),o=Object(f.useTagged)(A),c=t?t.board:E(r,o,0).board,a=c.length,l=c[0].length*H,u=a*H;return Object(W.jsxs)(_,{ref:e,children:[Object(W.jsx)("canvas",{id:U,style:{width:l,height:u,userSelect:"none",cursor:"pointer",pointerEvents:n?"none":void 0},"data-is-over":!!n,width:l,height:u,onClick:function(e){var n=z(e),r=Object(d.a)(n,2),o=r[0],a=r[1];t?F(c[o][a]):q(o,a)},onDoubleClick:t?function(e){var t=z(e),n=Object(d.a)(t,2),r=n[0],o=n[1];k(c[r][o])}:void 0,onContextMenu:t?function(e){e.preventDefault();var t=z(e),n=Object(d.a)(t,2),r=n[0],o=n[1];S(c[r][o])}:void 0}),Object(W.jsx)(Y,{parentRef:e,board:c,children:function(e){var t=e.cell;return Object(W.jsx)(X,{cell:t},t.id)}})]})},K=function(e,t,n){return Math.max(Math.min(t,n),e)},P=function(){var e=Object(f.useTagged)(I);return Object(W.jsxs)("label",{children:["Width:",Object(W.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return I(K(8,+(e.target.value||0),99))},min:8,max:99},e)]})},Q=function(){var e=Object(f.useTagged)(A);return Object(W.jsxs)("label",{children:["Height:",Object(W.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return A(K(1,+(e.target.value||0),99))},min:8,max:99},e)]})},Z=function(){var e=Object(f.useTagged)(L);return Object(W.jsxs)("label",{children:["Bomb count:",Object(W.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return L(K(0,+(e.target.value||0),I()*A()-1))},min:0,max:9800},e)]})},$=s.a.div(o||(o=Object(b.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 10px;\n"]))),ee=function(){return Object(W.jsxs)($,{children:[Object(W.jsx)(P,{}),Object(W.jsx)(Q,{}),Object(W.jsx)(Z,{})]})},te=function(){var e=Object(i.useReducer)((function(e){return e+1}),0),t=Object(d.a)(e,2)[1],n=Object(f.useTagged)(V),r=Object(f.useTagged)(p);return Object(i.useEffect)((function(){var e;return!r&&n&&(e=setInterval((function(){t()}),1e3)),function(){clearInterval(e)}}),[n,r]),Object(W.jsxs)("span",{children:["Time:",n?Math.floor(((r||Date.now())-n)/1e3):0]})},ne=function(){j(null),V(null),p(null),x(null)},re=function(){var e=Object(f.useTagged)(x);return Object(W.jsx)("button",{onClick:ne,children:"win"===e?"\ud83d\ude0e":"lose"===e?"\ud83d\ude35":"\ud83d\ude0a"})},oe=function(){var e=Object(f.useTagged)(L),t=Object(f.useTagged)(j(c||(c=Object(b.a)(["flags"]))));return Object(W.jsxs)("span",{children:["Flags:","number"===typeof t?t:e]})},ce=s.a.div(a||(a=Object(b.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 10px;\n"]))),ae=function(){return Object(W.jsxs)(ce,{children:[Object(W.jsx)(oe,{}),Object(W.jsx)(re,{}),Object(W.jsx)(te,{})]})},le=s.a.main(l||(l=Object(b.a)(["\n    display: flex;\n    flex-direction: column;\n    margin: auto;\n    height: calc(100vh - 20px);\n    padding-top: 20px;\n    width: calc(100vw - 40px);\n    align-items: center;\n"]))),ie=function(){return Object(W.jsxs)(le,{children:[Object(W.jsx)(ee,{}),Object(W.jsx)(ae,{}),Object(W.jsx)(G,{})]})};Object(u.render)(Object(W.jsx)(i.StrictMode,{children:Object(W.jsx)(ie,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.ca5a6fb8.chunk.js.map