(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{22:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var r,o,a,c,l=n(1),i=n(13),u=(n(22),n(5)),b=n(6),s=n(4),d=n(2),f=Object(d.createSignal)(null),j=n(3),g=function(e,t){for(var n,r=0,o=-1;o<=1;++o)for(n=-1;n<=1;++n){var a,c;(null===(c=null===(a=e.board[n+t.row])||void 0===a?void 0:a[o+t.col])||void 0===c?void 0:c.isBomb)&&++r}return r||null},O=function(e,t){for(var n,r,o,a,c=[t];c.length;)if((n=c.pop())&&!n.isOpened&&!n.isFlag&&(n=e.board[n.row][n.col]=Object(j.a)(Object(j.a)({},n),{},{isOpened:!0,bombCount:g(e,n)}),e.cells-=1,!n.bombCount))for(o=-1;o<=1;++o)for(a=-1;a<=1;++a){var l;!(r=null===(l=e.board[a+n.row])||void 0===l?void 0:l[o+n.col])||-1!==c.indexOf(r)||r.isOpened||r.isFlag||c.push(r)}return e},v=n(17),m=function(e){return Object(j.a)(Object(j.a)({},e),{},{board:Object(v.a)(e.board)})},h=Object(d.createSignal)(null),x=Object(d.createSignal)(null),p=function(e){for(var t,n=0,r=e.board.length,o=e.board[0].length;n<r;++n)for(t=0;t<o;t++)e.board[n][t].isBomb&&(e.board[n][t]=Object(j.a)(Object(j.a)({},e.board[n][t]),{},{isFlag:!0}));return e},w=function(){h(Date.now()),x("win"),f((function(e){return e&&p(m(e))}))},y=function(e){for(var t,n=0,r=e.board.length,o=e.board[0].length;n<r;++n)for(t=0;t<o;t++)e.board[n][t].isBomb&&(e.board[n][t]=Object(j.a)(Object(j.a)({},e.board[n][t]),{},{isOpened:!0}));return e},B=function(){h(Date.now()),x("lose"),f((function(e){return e&&y(m(e))}))},M=function(e){var t;!e||e.isOpened||e.isFlag||(e.isBomb?B():(f((function(t){return t&&O(m(t),e)})),0===(null===(t=f())||void 0===t?void 0:t.cells)&&w()))},T=function(e,t){if(!e)return 0;for(var n,r,o=0,a=!1,c=-1;c<=1;++c)for(n=-1;n<=1;++n){var l,i,u;(null===(i=r=null===(l=e.board[n+t.row])||void 0===l?void 0:l[c+t.col])||void 0===i?void 0:i.isFlag)?o++:(null===(u=r)||void 0===u?void 0:u.isBomb)&&(a=!0)}return o===t.bombCount?a?-1:1:0},F=function(e,t){for(var n,r=-1;r<=1;++r)for(n=-1;n<=1;++n){var o;O(e,null===(o=e.board[n+t.row])||void 0===o?void 0:o[r+t.col])}return e},S=function(e){switch(T(f(),e)){case-1:return void B();case 1:var t;f((function(t){return t&&F(m(t),e)})),0===(null===(t=f())||void 0===t?void 0:t.cells)&&w()}},C=function(e,t){var n=t.isFlag;return e.board[t.row][t.col]=Object(j.a)(Object(j.a)({},e.board[t.row][t.col]),{},{isFlag:!n}),e.flags+=n?1:-1,e},k=function(e){var t;!e.isOpened&&(e.isFlag||((null===(t=f())||void 0===t?void 0:t.flags)||0)>0)&&f((function(t){return t&&C(m(t),e)}))},R=function(e,t){return[Math.floor(Math.random()*t),Math.floor(Math.random()*e)]},D=function(e,t,n,r,o){for(var a,c=[],l=0,i=0;i<t;++i)for(c[i]=[],a=0;a<e;++a)c[i][a]={id:"[".concat(i,"][").concat(a,"]"),row:i,col:a,bombCount:null,isBomb:!1,isFlag:!1,isOpened:!1};for(;l<n;){var u=R(e,t),b=Object(s.a)(u,2);i=b[0],a=b[1],c[i][a].isBomb||i===r&&o===a||(c[i][a].isBomb=!0,++l)}return{board:c,flags:n,cells:e*t-n}},E=Object(d.createSignal)(30),I=Object(d.createSignal)(16),A=Object(d.createSignal)(99),L=Object(d.createSignal)(null),V=function(e,t){var n;f(D(E(),I(),A(),e,t)),L(Date.now()),M(null===(n=f())||void 0===n?void 0:n.board[e][t])},q=20,H=10,J="BOARD_ID",U={1:"blue",2:"green",3:"red",4:"purple",5:"maroon",6:"turquoise",7:"black",8:"gray"},N=n(0),W=Object(l.memo)((function(e){var t=e.cell;return Object(l.useLayoutEffect)((function(){var e=document.getElementById(J).getContext("2d");e&&function(e,t){var n=t.cell,r=n.col*q,o=n.row*q;e.fillStyle="black",e.fillRect(r,o,q,q),e.fillStyle=n.isOpened?"aliceblue":"lightgray",e.fillRect(r,o,19,19),e.font="12px -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif",e.textAlign="center",e.textBaseline="middle",n.isOpened?n.isBomb?n.isFlag?e.fillText("\u2705",r+H-1,o+H):e.fillText("\ud83d\udca3",r+H-1,o+H):n.bombCount&&(U[n.bombCount]&&(e.fillStyle=U[n.bombCount]),e.fillText("".concat(n.bombCount),r+H-1,o+H)):n.isFlag&&e.fillText("\ud83d\udea9",r+H-1,o+H)}(e,{cell:t})}),[t]),Object(N.jsx)(l.Fragment,{})})),X=function(e){var t=e.parentRef,n=e.board,r=e.children,o=Object(l.useState)((function(){return[[0,0],[0,0]]})),a=Object(s.a)(o,2),c=a[0],i=a[1];Object(l.useLayoutEffect)((function(){var e;return function n(){if(t.current){var r=t.current.getBoundingClientRect(),o=Math.max(Math.floor(t.current.scrollTop/q),0),a=Math.max(Math.ceil((t.current.scrollTop+r.height)/q),0),c=Math.max(Math.floor(t.current.scrollLeft/q),0),l=Math.max(Math.ceil((t.current.scrollLeft+r.width)/q),0);i((function(e){return e[0][0]===o&&e[0][1]===a&&e[1][0]===c&&e[1][1]===l?e:[[o,a],[c,l]]}))}e=requestAnimationFrame(n)}(),function(){cancelAnimationFrame(e)}}),[t]);var u=Object(l.useMemo)((function(){for(var e,t=[],o=c[0][0],a=n.length,l=n[0].length;o<c[0][1]&&o<a;++o)for(e=c[1][0];e<c[1][1]&&e<l;++e)t.push(r({cell:n[o][e]}));return t}),[n,r,c]);return Object(N.jsx)(l.Fragment,{children:u})},Y=b.a.section(r||(r=Object(u.a)(["\n    display: flex;\n    overflow: auto;\n    max-width: 100%;\n    border-top: 1px solid black;\n    border-left: 1px solid black;\n"]))),_=function(e){var t,n=null===(t=document.getElementById(J))||void 0===t?void 0:t.getBoundingClientRect();return n?[Math.floor((e.clientY-n.top)/q),Math.floor((e.clientX-n.left)/q)]:[0,0]},z=function(){var e=Object(l.useRef)(null),t=Object(d.useTagged)(f),n=Object(d.useTagged)(x),r=Object(d.useTagged)(E),o=Object(d.useTagged)(I),a=t?t.board:D(r,o,0).board,c=a.length,i=a[0].length*q,u=c*q;return Object(N.jsxs)(Y,{ref:e,children:[Object(N.jsx)("canvas",{id:J,style:{width:i,height:u,userSelect:"none",cursor:"pointer",pointerEvents:n?"none":void 0},"data-is-over":!!n,width:i,height:u,onClick:function(e){var n=_(e),r=Object(s.a)(n,2),o=r[0],c=r[1];t?M(a[o][c]):V(o,c)},onDoubleClick:t?function(e){var t=_(e),n=Object(s.a)(t,2),r=n[0],o=n[1];S(a[r][o])}:void 0,onContextMenu:t?function(e){e.preventDefault();var t=_(e),n=Object(s.a)(t,2),r=n[0],o=n[1];k(a[r][o])}:void 0}),Object(N.jsx)(X,{parentRef:e,board:a,children:function(e){var t=e.cell;return Object(N.jsx)(W,{cell:t},t.id)}})]})},G=function(e,t,n){return Math.max(Math.min(t,n),e)},K=function(){var e=Object(d.useTagged)(E);return Object(N.jsxs)("label",{children:["Width:",Object(N.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return E(G(8,+(e.target.value||0),819))},min:8,max:819},e)]})},P=function(){var e=Object(d.useTagged)(I);return Object(N.jsxs)("label",{children:["Height:",Object(N.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return I(G(1,+(e.target.value||0),819))},min:8,max:819},e)]})},Q=function(){var e=Object(d.useTagged)(A),t=Object(d.useTagged)(E),n=Object(d.useTagged)(I);return Object(N.jsxs)("label",{children:["Bomb count:",Object(N.jsx)("input",{defaultValue:e,type:"number",onBlur:function(e){return A(G(0,+(e.target.value||0),t*n-1))},min:0,max:t*n-1},e)]})},Z=b.a.div(o||(o=Object(u.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 10px;\n    flex-wrap: wrap;\n"]))),$=function(){return Object(N.jsxs)(Z,{children:[Object(N.jsx)(K,{}),Object(N.jsx)(P,{}),Object(N.jsx)(Q,{})]})},ee=function(){var e=Object(l.useReducer)((function(e){return e+1}),0),t=Object(s.a)(e,2)[1],n=Object(d.useTagged)(L),r=Object(d.useTagged)(h);return Object(l.useEffect)((function(){var e;return!r&&n&&(e=setInterval((function(){t()}),1e3)),function(){clearInterval(e)}}),[n,r]),Object(N.jsxs)("span",{children:["Time:",n?Math.floor(((r||Date.now())-n)/1e3):0]})},te=function(){f(null),L(null),h(null),x(null)},ne=function(){var e=Object(d.useTagged)(x);return Object(N.jsx)("button",{onClick:te,children:"win"===e?"\ud83d\ude0e":"lose"===e?"\ud83d\ude35":"\ud83d\ude0a"})},re=function(){var e=Object(d.useTagged)(A),t=Object(d.useTagged)((function(){var e;return null===(e=f())||void 0===e?void 0:e.flags}));return Object(N.jsxs)("span",{children:["Flags:","number"===typeof t?t:e]})},oe=b.a.div(a||(a=Object(u.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 10px;\n"]))),ae=function(){return Object(N.jsxs)(oe,{children:[Object(N.jsx)(re,{}),Object(N.jsx)(ne,{}),Object(N.jsx)(ee,{})]})},ce=b.a.main(c||(c=Object(u.a)(["\n    display: flex;\n    flex-direction: column;\n    margin: auto;\n    height: calc(100vh - 20px);\n    padding-top: 20px;\n    width: calc(100vw - 40px);\n    align-items: center;\n"]))),le=function(){return Object(N.jsxs)(ce,{children:[Object(N.jsx)($,{}),Object(N.jsx)(ae,{}),Object(N.jsx)(z,{})]})};Object(i.render)(Object(N.jsx)(l.StrictMode,{children:Object(N.jsx)(le,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.14496b5e.chunk.js.map